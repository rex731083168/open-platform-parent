<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.ce.platform_service.gateway.dao.IMysqlSaasDao">
	<resultMap type="cn.ce.platform_service.gateway.entity.SaasEntity" id="saasMap">
		<result column="saas_id" property="saas_id"/>
		<result column="resource_type" property="resource_type"/>
		<result column="target_url" property="target_url"/>
	</resultMap>


	<insert id="save" parameterType="cn.ce.platform_service.gateway.entity.SaasEntity">
		INSERT INTO saas
			(saas_id,resource_type,target_url)
		VALUES
			(#{saas_id},#{resource_type},#{target_url})
	</insert>

	<delete id="clearAll">
		delete from saas where uuid > 0
	</delete>
	
	<select id="getSaas" resultMap="saasMap">
		select 
			saas_id,resource_type,target_url
		from saas 
			where saas_id = #{saas_id} and resource_type=#{resource_type}
	</select>
	
	<select id="getSandboxSaas" resultMap="saasMap">
		select 
			saas_id,resource_type,target_url,sandbox_id
		from saas 
			where saas_id = #{saas_id} and resource_type=#{resource_type}
			and sandbox_id = #{sandbox_id}
	</select>	
	
	<delete id="deleteSaas">
		delete from saas where
			saas_id=#{saas_id} and resource_type=#{resource_type}
	</delete>
	
	<delete id="deleteSandboxSaas">
		delete from saas where
			saas_id=#{saas_id} and resource_type=#{resource_type}
			and sandbox_id=#{sandbox_id}
	</delete>
	
	<update id="updateSaas">
		update saas set  
			target_url = #{target_url} 
		where 
			saas_id=#{saas_id} and resource_type=#{resource_type} 
	</update>
	
	<update id="updateSandboxSaas">
		update saas set  
			target_url = #{target_url} 
		where 
			saas_id=#{saas_id} and resource_type=#{resource_type} 
			and sandbox_id=#{sandbox_id}
	</update>
	
	<select id="getSandBoxRouterList" resultMap="saasMap">
		select 
			saas_id,resource_type,target_url,sandbox_id 
		from saas 
		<where>
		
			<if test="saas_id != null">
				and saas_id = #{saas_id}
			</if>
			
			<if test="resource_type != null">
				and resource_type = #{resource_type}
			</if>		
				
			<if test="sandbox_id != null">
				and sandbox_id = #{sandbox_id}
			</if>
			
		</where>
	</select>	
	
</mapper>